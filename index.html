<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Sarabun', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            min-height: 80vh;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .content {
            padding: 40px;
            min-height: 500px;
        }

        .page {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
        }

        .btn-disabled {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: not-allowed;
            font-size: 16px;
            font-weight: bold;
            opacity: 0.6;
            text-decoration: none;
            display: inline-block;
            margin: 10px 5px;
        }

        .btn-disabled:hover {
            transform: none;
            box-shadow: none;
            opacity: 0.6;
        }

        .clip-progress {
            margin: 20px 0;
            text-align: center;
        }

        .clip-progress-bar {
            background: #e1e5e9;
            border-radius: 25px;
            height: 12px;
            margin: 10px 0;
            overflow: hidden;
            position: relative;
        }

        .clip-progress-fill {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            height: 100%;
            border-radius: 25px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .clip-progress-text {
            font-size: 14px;
            color: #666;
            margin-top: 5px;
        }

        .criterion.completed {
            border-left-color: #2ecc71;
            background: #f8fff8;
        }

        .criterion.incomplete {
            border-left-color: #ffc107;
            background: #fffdf7;
        }

        .tiktok-container {
            width: 100%;
            margin: 20px 0;
            text-align: center;
            padding: 0 10px;
        }

        .tiktok-embed-container {
            width: 100%;
            max-width: 100%;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            overflow-x: auto;
        }

        .tiktok-fallback {
            text-align: center;
            padding: 40px;
            background: #fff;
            border-radius: 15px;
            border: 2px dashed #ddd;
            max-width: 400px;
            margin: 0 auto;
        }

        .tiktok-fallback h3 {
            color: #666;
            margin-bottom: 15px;
        }

        .tiktok-fallback p {
            color: #888;
            margin-bottom: 20px;
        }

        .scoring-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin: 30px 0;
        }

        .criterion {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .criterion h4 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1em;
        }

        .score-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .score-btn {
            width: 50px;
            height: 50px;
            border: 2px solid #e1e5e9;
            background: white;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            font-size: 18px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .score-btn:hover {
            border-color: #667eea;
            background: #f0f3ff;
        }

        .score-btn.selected {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: #667eea;
        }

        .summary-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #667eea;
        }

        .clip-summary {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .alert-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }

        .alert-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .progress-container {
            background: #e1e5e9;
            border-radius: 25px;
            height: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            height: 100%;
            border-radius: 25px;
            transition: width 0.3s ease;
            width: 0%;
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        .admin-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .content {
                padding: 20px;
            }

            .header h1 {
                font-size: 2em;
            }

            .tiktok-embed {
                height: 500px;
            }

            .score-buttons {
                justify-content: center;
            }
        }

        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }

        .closed-message {
            background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
        }

        .closed-message h2 {
            margin-bottom: 15px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1 id="headerTitle">üé¨ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok</h1>
            <p id="headerSubtitle">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok</p>
        </div>

        <div class="content">
            <!-- Loading Page -->
            <div id="page-loading" class="page">
                <div class="loading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏∞‡∏ö‡∏ö...</p>
                    <p style="font-size: 14px; color: #666; margin-top: 10px;">
                        <span id="loadingStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</span>
                    </p>
                </div>
            </div>

            <!-- System Closed Page -->
            <div id="page-closed" class="page">
                <div class="closed-message">
                    <h2>üîí ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß</h2>
                    <p>‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß</p>
                    <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ô‡πÉ‡∏à</p>
                </div>
            </div>

            <!-- Welcome Page -->
            <div id="page-welcome" class="page active">
                <div class="text-center">
                    <h2>üéâ ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>
                    <p style="margin: 20px 0;">‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô <strong>7 ‡∏Ñ‡∏•‡∏¥‡∏õ TikTok</strong> ‡∏î‡πâ‡∏ß‡∏¢‡πÄ‡∏Å‡∏ì‡∏ë‡πå 10 ‡∏Ç‡πâ‡∏≠</p>
                    <p><strong>‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£:</strong> <span id="judgeName">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span></p>

                    <div class="alert alert-success">
                        <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong><br>
                        ‚Ä¢ ‡∏î‡∏π‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏´‡πâ‡∏à‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô<br>
                        ‚Ä¢ ‡πÉ‡∏´‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡πâ‡∏≠ 1-5 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô<br>
                        ‚Ä¢ ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÑ‡∏î‡πâ‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢
                    </div>

                    <div id="welcomeActions">
                        <button class="btn btn-success" onclick="startEvaluation()">üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</button>
                    </div>

                    <!-- ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏°‡∏µ token -->
                    <div id="noTokenMessage" class="hidden">
                        <div class="alert alert-warning">
                            <strong>‚ö†Ô∏è ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</strong><br>
                            ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
                        </div>

                        <!-- Admin Login Form -->
                        <div class="admin-panel" style="margin-top: 20px;">
                            <h3 style="margin-bottom: 15px;">üîê ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h3>

                            <div class="form-group">
                                <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ:</label>
                                <input type="text" id="quickAdminUsername" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" value="scores1"
                                    style="max-width: 300px; margin: 0 auto;">
                            </div>

                            <div class="form-group">
                                <label>‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:</label>
                                <input type="password" id="quickAdminPassword" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô"
                                    onkeypress="if(event.key==='Enter') quickAdminLogin()"
                                    style="max-width: 300px; margin: 0 auto;">
                            </div>

                            <div style="text-align: center; margin-top: 15px;">
                                <button class="btn btn-success" onclick="quickAdminLogin()">üîë
                                    ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</button>
                            </div>

                            <div style="margin-top: 10px; font-size: 12px; color: #666;">
                                <strong>¬© 2025 Nipon by SpicyDev | All rights reserved</strong>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Clip Evaluation Pages -->
            <div id="page-clip-1" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 1 : ‡πÄ‡∏ö‡πâ‡∏ö</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-1" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-1" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-1" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-1"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-1" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('welcome')">‚Üê ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö</button>
                        <button id="next-btn-1" class="btn-disabled" disabled onclick="nextClip(1)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-2" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 2 : ‡πÄ‡∏à‡∏•‡∏¥</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-2" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-2" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-2" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-2"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-2" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-1')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 1 : ‡πÄ‡∏ö‡πâ‡∏ö</button>
                        <button id="next-btn-2" class="btn-disabled" disabled onclick="nextClip(2)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-3" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 3 : ‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-3" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-3" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-3" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-3"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-3" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-2')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 2 : ‡πÄ‡∏à‡∏•‡∏¥</button>
                        <button id="next-btn-3" class="btn-disabled" disabled onclick="nextClip(3)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-4" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 4 : Sm</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-4" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-4" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-4" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-4"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-4" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-3')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 3 : ‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà</button>
                        <button id="next-btn-4" class="btn-disabled" disabled onclick="nextClip(4)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-5" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 5 : xtr_4440</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-5" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-5" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-5" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-5"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-5" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-4')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 4 : Sm</button>
                        <button id="next-btn-5" class="btn-disabled" disabled onclick="nextClip(5)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-6" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 6 : thisisnarumi</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-6" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-6" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-6" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-6"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-6" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-5')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 5 : xtr_4440</button>
                        <button id="next-btn-6" class="btn-disabled" disabled onclick="nextClip(6)">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <div id="page-clip-7" class="page">
                <div class="text-center">
                    <h2>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 7 : wtlp93</h2>

                    <!-- Progress Bar -->
                    <div class="clip-progress">
                        <div class="clip-progress-bar">
                            <div id="clip-progress-7" class="clip-progress-fill"></div>
                        </div>
                        <div id="clip-progress-text-7" class="clip-progress-text">0/10 ‡∏Ç‡πâ‡∏≠ (0%)</div>
                    </div>

                    <div class="tiktok-container">
                        <div id="tiktok-7" class="tiktok-embed-container">
                            <!-- TikTok embed ‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                        </div>
                    </div>

                    <div class="scoring-section">
                        <h3>üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                        <div id="scoring-7"></div>
                    </div>

                    <!-- Warning Message -->
                    <div id="warning-7" style="display: none;"></div>

                    <div class="text-center">
                        <button class="btn btn-secondary" onclick="goToPage('clip-6')">‚Üê ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 6 : thisisnarumi</button>
                        <button id="next-btn-7" class="btn-disabled" disabled onclick="goToSummary()">‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö
                            (0/10)</button>
                    </div>
                </div>
            </div>

            <!-- Summary Page -->
            <div id="page-summary" class="page">
                <div class="text-center">
                    <h2>üìä ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô</h2>

                    <div class="alert alert-warning">
                        <strong>‚ö†Ô∏è ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á:</strong><br>
                        ‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å
                    </div>

                    <div id="summaryContent"></div>

                    <div class="text-center" style="margin-top: 30px;">
                        <button class="btn btn-secondary" onclick="goToPage('clip-7')">‚Üê ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                        <button id="submit-btn" class="btn btn-success" onclick="submitAllScores()">‚úÖ
                            ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                    </div>
                </div>
            </div>

            <!-- Thank You Page -->
            <div id="page-thanks" class="page">
                <div class="text-center">
                    <h2>üôè ‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h2>

                    <div class="alert alert-success">
                        <h3>‚úÖ ‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå</h3>
                        <p>‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏£‡∏≠‡∏ö‡∏Ñ‡∏≠‡∏ö</p>
                        <p>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
                    </div>

                    <p>üìà ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏ß‡∏î‡∏à‡∏∞‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á</p>
                </div>
            </div>

            <!-- Admin Panel (Hidden by default) -->
            <div id="page-admin" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2>üîß ‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
                    <button class="btn btn-secondary" onclick="adminLogout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
                </div>

                <div class="admin-panel">
                    <h3>üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏∞‡∏ö‡∏ö</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalJudges">0</div>
                            <div>‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="completedJudges">0</div>
                            <div>‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="averageWinner">0</div>
                            <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î</div>
                        </div>
                    </div>
                </div>

                <div class="admin-panel">
                    <h3>üéõÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
                    <div class="form-group">
                        <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö:</label>
                        <select id="systemStatus">
                            <option value="open">üü¢ ‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</option>
                            <option value="closed">üî¥ ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</option>
                        </select>
                    </div>
                    <button class="btn" onclick="updateSystemStatus()">üíæ ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</button>
                </div>

                <div class="admin-panel">
                    <h3>üë®‚Äç‚öñÔ∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£</h3>
                    <button class="btn btn-success" onclick="createAllJudges()">üöÄ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ 10 ‡∏Ñ‡∏ô</button>
                    <button class="btn" onclick="showJudgeLinks()">üîó ‡πÅ‡∏™‡∏î‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>

                    <div id="judgeLinksDisplay" class="hidden"
                        style="margin-top: 20px; max-height: 400px; overflow-y: auto;"></div>
                </div>

                <div class="admin-panel">
                    <h3>üìà ‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</h3>
                    <button class="btn" onclick="showResults()">üìä ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                    <button class="btn btn-danger" onclick="exportResults()">üìã ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>

                    <div id="resultsDisplay" class="hidden" style="margin-top: 20px;"></div>
                </div>
            </div>

            <!-- Loading -->
            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</p>
            </div>
        </div>
    </div>

    <script>
        // ‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ñ‡πà‡∏≤‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏ï‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå Supabase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const SUPABASE_CONFIG = {
            url: 'https://qrlphourtlxfoqyptxpb.supabase.co',
            key: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFybHBob3VydGx4Zm9xeXB0eHBiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg1MjAwMzgsImV4cCI6MjA2NDA5NjAzOH0.DIjGkjuvLGzHcu8SzZwOwM_n9-ZXDJMvVVBK_UAww2g'
        };

        // ‡∏Ñ‡∏•‡∏¥‡∏õ TikTok ‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        const CLIPS = {
            1: {
                url: 'https://www.tiktok.com/@3abygiirl1/video/7501351084003298581',
                videoId: '7501351084003298581',
                username: '3abygiirl1',
                title: '‡πÄ‡∏ö‡πâ‡∏ö'
            },
            2: {
                url: 'https://www.tiktok.com/@joojoob00/video/7500959013140565266',
                videoId: '7500959013140565266',
                username: 'joojoob00',
                title: '‡πÄ‡∏à‡∏•‡∏¥ - ‡∏•‡∏á‡∏≠‡∏µ‡∏Å‡∏£‡∏≠‡∏ö‡∏ô‡∏∂‡∏á ‡∏•‡∏∑‡∏°‡πÉ‡∏™‡πà‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ä‡∏ó‡πÉ‡∏´‡πâ‡∏î‡∏πüò≠ #fyp #chatbot #ai #sillytavern #sillytavernth2025'
            },
            3: {
                url: 'https://www.tiktok.com/@nahamary.4165/video/7507332065063341319',
                videoId: '7507332065063341319',
                username: 'nahamary.4165',
                title: 'nahamary - ‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà'
            },
            4: {
                url: 'https://www.tiktok.com/@hellohihieieie/video/7507331530637823240',
                videoId: '7507331530637823240',
                username: 'hellohihieieie',
                title: 'hellohihieieie - Sm'
            },
            5: {
                url: 'https://www.tiktok.com/@xtr_4440/video/7506926701599804688',
                videoId: '7506926701599804688',
                username: 'xtr_4440',
                title: 'xtr_4440'
            },
            6: {
                url: 'https://www.tiktok.com/@thisisnarumi/video/7501303102021192978',
                videoId: '7501303102021192978',
                username: 'thisisnarumi',
                title: 'thisisnarumi'
            },
            7: {
                url: 'https://www.tiktok.com/@wtlp93/video/7500995607889300744',
                videoId: '7500995607889300744',
                username: 'wtlp93',
                title: 'wtlp93'
            }
        };

        // Global Variables - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç scores object ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        let supabase = null;
        let currentJudge = null;
        let scores = { 1: {}, 2: {}, 3: {}, 4: {}, 5: {}, 6: {}, 7: {} }; // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏•‡∏¥‡∏õ 5, 6, 7
        let systemSettings = { status: 'open' };
        let isAdminLoggedIn = false;

        const criteria = [
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö',
            '‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤',
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ö‡∏±‡∏ô‡πÄ‡∏ó‡∏¥‡∏á',
            '‡∏ó‡∏±‡∏Å‡∏©‡∏∞‡∏Å‡∏≤‡∏£‡∏ñ‡πà‡∏≤‡∏¢‡∏ó‡∏≥‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏ï‡πà‡∏≠',
            '‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡πÄ‡∏™‡∏µ‡∏¢‡∏á/‡∏î‡∏ô‡∏ï‡∏£‡∏µ',
            '‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÅ‡∏•‡∏∞‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏†‡∏≤‡∏û',
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏°‡∏Å‡∏±‡∏ö‡πÄ‡∏ó‡∏£‡∏ô‡∏î‡πå',
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢',
            '‡∏Å‡∏≤‡∏£‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡∏ä‡∏°',
            '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡∏ó‡∏±‡∏ö‡πÉ‡∏à‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏°'
        ];

        // Initialize System
        document.addEventListener('DOMContentLoaded', async function () {
            try {
                console.log('üöÄ Starting system initialization...');
                console.log('üìç Current URL:', window.location.href);
                console.log('üîê Admin login status:', localStorage.getItem('adminLoggedIn'));

                goToPage('loading');
                updateLoadingStatus('‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö...');

                await initializeSystem();
                updateLoadingStatus('‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á...');

                checkUrlParams();
                updateLoadingStatus('‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏•‡∏¥‡∏õ TikTok...');

                loadTikTokScript();
                updateLoadingStatus('‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô...');

                generateScoringForms();
                updateLoadingStatus('‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');

                console.log('‚úÖ System initialized successfully');

                setTimeout(() => {
                    const loadingPage = document.getElementById('page-loading');
                    if (loadingPage && loadingPage.classList.contains('active')) {
                        loadingPage.classList.remove('active');
                        console.log('‚úÖ Loading page hidden');
                    }
                }, 1000);

            } catch (error) {
                console.error('‚ùå System initialization failed:', error);
                updateLoadingStatus('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î');

                setTimeout(() => {
                    document.getElementById('page-loading').innerHTML = `
                        <div class="text-center">
                            <h2>‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</h2>
                            <div class="alert alert-error">
                                <strong>‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</strong> ${error.message}<br><br>
                                <strong>‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</strong><br>
                                1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï<br>
                                2. ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö<br>
                                3. ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö
                            </div>
                            <button class="btn" onclick="location.reload()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö</button>
                            <button class="btn btn-secondary" onclick="clearAdminCache()">üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Cache</button>
                        </div>
                    `;
                }, 1000);
            }
        });

        function clearAdminCache() {
            localStorage.removeItem('adminLoggedIn');
            alert('‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Cache ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä...');
            location.reload();
        }

        function updateLoadingStatus(message) {
            const statusElement = document.getElementById('loadingStatus');
            if (statusElement) {
                statusElement.textContent = message;
            }
        }

        async function initializeSystem() {
            try {
                console.log('üîß Initializing Supabase...');

                if (typeof window.supabase === 'undefined') {
                    throw new Error('Supabase library ‡πÑ‡∏°‡πà‡πÇ‡∏´‡∏•‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö');
                }

                if (!SUPABASE_CONFIG.url || !SUPABASE_CONFIG.key) {
                    throw new Error('‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Supabase ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                }

                supabase = window.supabase.createClient(SUPABASE_CONFIG.url, SUPABASE_CONFIG.key);
                console.log('‚úÖ Supabase connected');

                await setupDatabase();
                await checkSystemStatus();

                console.log('‚úÖ Database ready');

            } catch (error) {
                console.error('‚ùå System initialization error:', error);
                throw error;
            }
        }

        async function setupDatabase() {
            try {
                const { data, error } = await supabase.from('judges').select('count').limit(1);

                if (error && error.code === 'PGRST116') {
                    console.log('Database tables need to be created');
                    showSetupInstructions();
                }
            } catch (error) {
                console.error('Database setup error:', error);
            }
        }

        function showSetupInstructions() {
            if (window.location.search.includes('admin=true')) {
                alert(`‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô

‡πÑ‡∏õ‡∏ó‡∏µ‡πà Supabase Dashboard ‚Üí SQL Editor ‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ:

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á judges
CREATE TABLE IF NOT EXISTS judges (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  name TEXT NOT NULL,
  access_token TEXT UNIQUE NOT NULL,
  used BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á scores  
CREATE TABLE IF NOT EXISTS scores (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  judge_id UUID REFERENCES judges(id),
  clip_id INTEGER NOT NULL,
  q1 INTEGER, q2 INTEGER, q3 INTEGER, q4 INTEGER, q5 INTEGER,
  q6 INTEGER, q7 INTEGER, q8 INTEGER, q9 INTEGER, q10 INTEGER,
  total_score INTEGER,
  created_at TIMESTAMP DEFAULT NOW()
);

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á settings
CREATE TABLE IF NOT EXISTS settings (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  key TEXT UNIQUE NOT NULL,
  value TEXT NOT NULL,
  updated_at TIMESTAMP DEFAULT NOW()
);

-- ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÉ‡∏ô settings ‡∏Å‡πà‡∏≠‡∏ô (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
DELETE FROM settings WHERE key = 'system_status';

-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
INSERT INTO settings (key, value) VALUES ('system_status', 'open');

-- ‡∏õ‡∏¥‡∏î RLS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ
ALTER TABLE judges DISABLE ROW LEVEL SECURITY;
ALTER TABLE scores DISABLE ROW LEVEL SECURITY;
ALTER TABLE settings DISABLE ROW LEVEL SECURITY;

‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏£‡∏±‡∏ô SQL ‡πÄ‡∏™‡∏£‡πá‡∏à`);
            }
        }

        async function checkSystemStatus() {
            try {
                const { data } = await supabase
                    .from('settings')
                    .select('value')
                    .eq('key', 'system_status')
                    .single();

                systemSettings.status = data?.value || 'open';

                if (systemSettings.status === 'closed' && !window.location.search.includes('admin=true')) {
                    goToPage('closed');
                }

            } catch (error) {
                console.log('Settings not found, using default');
            }
        }

        function checkUrlParams() {
            try {
                const urlParams = new URLSearchParams(window.location.search);
                const token = urlParams.get('token');
                const isAdmin = urlParams.get('admin');

                console.log('üîç Checking URL params...', { token: !!token, isAdmin });

                if (isAdmin === 'true') {
                    console.log('üîß Admin access requested');
                    const adminLoggedIn = localStorage.getItem('adminLoggedIn');
                    console.log('üîë Admin login status:', adminLoggedIn);

                    if (adminLoggedIn === 'true') {
                        console.log('‚úÖ Admin already logged in, going to admin panel');
                        isAdminLoggedIn = true;
                        goToPage('admin');
                        loadAdminStats();
                    } else {
                        console.log('üîí Admin not logged in, showing login page');
                        isAdminLoggedIn = false;
                        goToPage('admin-login');
                    }
                    return;
                }

                if (token) {
                    console.log('üé´ Token found, loading judge...');
                    loadJudgeByToken(token);
                } else {
                    console.log('üè† No token, showing default page...');

                    goToPage('welcome');
                    document.getElementById('judgeName').textContent = '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏à‡∏≤‡∏Å‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô';
                    document.getElementById('noTokenMessage').classList.remove('hidden');
                    document.getElementById('welcomeActions').classList.add('hidden');

                    if (systemSettings.status === 'closed') {
                        setTimeout(() => goToPage('closed'), 500);
                    }
                }

            } catch (error) {
                console.error('Error checking URL params:', error);
                goToPage('welcome');
                document.getElementById('judgeName').textContent = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î';
                document.getElementById('noTokenMessage').classList.remove('hidden');
                document.getElementById('welcomeActions').classList.add('hidden');
            }
        }

        function quickAdminLogin() {
            console.log('üîë Quick admin login attempt...');

            const username = document.getElementById('quickAdminUsername').value;
            const password = document.getElementById('quickAdminPassword').value;

            if (username === 'scores1' && password === 'Admin-01') {
                console.log('‚úÖ Quick admin credentials correct');
                localStorage.setItem('adminLoggedIn', 'true');
                isAdminLoggedIn = true;

                console.log('üöÄ Redirecting to admin panel');
                goToPage('admin');
                loadAdminStats();

                alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } else {
                console.log('‚ùå Invalid quick admin credentials');
                alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                document.getElementById('quickAdminPassword').value = '';
                document.getElementById('quickAdminUsername').focus();
            }
        }

        function adminLogin() {
            console.log('üîë Attempting admin login...');

            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;

            console.log('Username:', username);

            if (username === 'scores1' && password === 'Admin-01') {
                console.log('‚úÖ Admin credentials correct');
                localStorage.setItem('adminLoggedIn', 'true');
                isAdminLoggedIn = true;

                console.log('üöÄ Redirecting to admin panel');
                goToPage('admin');
                loadAdminStats();

                alert('‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } else {
                console.log('‚ùå Invalid admin credentials');
                alert('‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminUsername').focus();
            }
        }

        function adminLogout() {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                console.log('üö™ Admin logout');
                localStorage.removeItem('adminLoggedIn');
                isAdminLoggedIn = false;
                goToPage('admin-login');
            }
        }

        function loadTikTokScript() {
            if (!document.querySelector('script[src*="tiktok.com/embed.js"]')) {
                const script = document.createElement('script');
                script.src = 'https://www.tiktok.com/embed.js';
                script.async = true;
                document.head.appendChild(script);

                script.onload = function () {
                    console.log('TikTok embed script loaded');
                    loadClips();
                };

                script.onerror = function () {
                    console.error('Failed to load TikTok embed script');
                    loadClipsWithFallback();
                };
            } else {
                loadClips();
            }
        }

        function loadClips() {
            Object.keys(CLIPS).forEach(clipNum => {
                const clipData = CLIPS[clipNum];
                const container = document.getElementById(`tiktok-${clipNum}`);

                if (!clipData.videoId) {
                    showClipFallback(clipNum, clipData.url || `‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum}`);
                    return;
                }

                const embedHTML = `
                    <blockquote class="tiktok-embed" 
                        cite="${clipData.url}" 
                        data-video-id="${clipData.videoId}" 
                        style="max-width: 605px; min-width: 325px; margin: 0 auto;">
                        <section>
                            <a target="_blank" title="@${clipData.username}" href="https://www.tiktok.com/@${clipData.username}?refer=embed">
                                @${clipData.username}
                            </a>
                            <p>${clipData.title}</p>
                            <a target="_blank" href="${clipData.url}?refer=embed">‡∏î‡∏π‡πÉ‡∏ô TikTok</a>
                        </section>
                    </blockquote>
                `;

                container.innerHTML = embedHTML;

                setTimeout(() => {
                    if (window.tiktokEmbed) {
                        window.tiktokEmbed.lib.render();
                    }
                }, 1000);
            });
        }

        function loadClipsWithFallback() {
            Object.keys(CLIPS).forEach(clipNum => {
                const clipData = CLIPS[clipNum];
                showClipFallback(clipNum, clipData.url || `‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum}`);
            });
        }

        function showClipFallback(clipNum, clipUrl) {
            const container = document.getElementById(`tiktok-${clipNum}`);
            container.innerHTML = `
                <div class="tiktok-fallback">
                    <div style="font-size: 48px; margin-bottom: 20px;">üì±</div>
                    <h3>‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum}</h3>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏ô TikTok</p>
                    <a href="${clipUrl}" target="_blank" class="btn" style="text-decoration: none;">
                        üîó ‡∏î‡∏π‡∏Ñ‡∏•‡∏¥‡∏õ‡πÉ‡∏ô TikTok
                    </a>
                    <p style="font-size: 12px; color: #aaa; margin-top: 15px;">
                        ‡∏î‡∏π‡∏Ñ‡∏•‡∏¥‡∏õ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô
                    </p>
                </div>
            `;
        }

        function convertTikTokUrl(url) {
            if (url.includes('tiktok.com') && !url.includes('/embed')) {
                return url.replace('www.tiktok.com', 'www.tiktok.com/embed');
            }
            return url;
        }

        async function loadJudgeByToken(token) {
            try {
                console.log('üé´ Loading judge by token...');

                if (!supabase) {
                    throw new Error('‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö');
                }

                const { data, error } = await supabase
                    .from('judges')
                    .select('*')
                    .eq('access_token', token)
                    .single();

                if (error || !data) {
                    throw new Error('‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏');
                }

                if (data.used) {
                    console.log('‚úÖ Judge already completed evaluation');
                    document.getElementById('judgeName').textContent = data.name;
                    goToPage('thanks');
                    return;
                }

                currentJudge = data;
                document.getElementById('judgeName').textContent = data.name;

                console.log(`‚úÖ Judge loaded: ${data.name}`);

                if (systemSettings.status === 'closed') {
                    goToPage('closed');
                } else {
                    goToPage('welcome');
                    document.getElementById('noTokenMessage').classList.add('hidden');
                    document.getElementById('welcomeActions').classList.remove('hidden');
                }

            } catch (error) {
                console.error('Error loading judge:', error);

                document.getElementById('judgeName').textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
                document.getElementById('noTokenMessage').classList.remove('hidden');
                document.getElementById('welcomeActions').classList.add('hidden');

                setTimeout(() => {
                    alert(error.message);
                }, 500);
            }
        }

        function goToPage(pageName) {
            try {
                console.log(`üìÑ Navigating to page: ${pageName}`);

                document.querySelectorAll('.page').forEach(page => {
                    page.classList.remove('active');
                });

                const targetPage = document.getElementById(`page-${pageName}`);
                if (targetPage) {
                    targetPage.classList.add('active');
                    console.log(`‚úÖ Page ${pageName} displayed successfully`);

                    const titles = {
                        'welcome': '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok',
                        'clip-1': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 1 : ‡πÄ‡∏ö‡πâ‡∏ö',
                        'clip-2': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 2 : ‡πÄ‡∏à‡∏•‡∏¥',
                        'clip-3': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 3 : ‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà',
                        'clip-4': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 4 : Sm',
                        'clip-5': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 5 : xtr_4440',
                        'clip-6': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 6 : thisisnarumi',
                        'clip-7': '‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 7 : wtlp93',
                        'summary': '‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô',
                        'thanks': '‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏£‡πà‡∏ß‡∏°‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô',
                        'admin': '‡πÅ‡∏ú‡∏á‡∏Ñ‡∏ß‡∏ö‡∏Ñ‡∏∏‡∏°‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô',
                        'admin-login': '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô',
                        'closed': '‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß'
                    };

                    const subtitle = document.getElementById('headerSubtitle');
                    if (subtitle) {
                        subtitle.textContent = titles[pageName] || '‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok';
                    }

                    if (pageName === 'summary') {
                        generateSummary();
                    }

                } else {
                    console.error(`‚ùå Page not found: page-${pageName}`);
                    const welcomePage = document.getElementById('page-welcome');
                    if (welcomePage) {
                        welcomePage.classList.add('active');
                        console.log('üìÑ Fallback to welcome page');
                    }
                }

            } catch (error) {
                console.error('Error navigating to page:', error);
                try {
                    document.getElementById('page-welcome').classList.add('active');
                } catch (e) {
                    console.error('Critical error: Cannot show any page');
                }
            }
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç generateScoringForms ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        function generateScoringForms() {
            for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                const container = document.getElementById(`scoring-${clipNum}`);
                let html = '';

                criteria.forEach((criterion, index) => {
                    html += `
                        <div class="criterion incomplete" id="criterion-${clipNum}-${index}">
                            <h4>${index + 1}. ${criterion}</h4>
                            <div class="score-buttons">
                                ${[1, 2, 3, 4, 5].map(score => `
                                    <button type="button" class="score-btn" 
                                            onclick="setScore(${clipNum}, ${index}, ${score})"
                                            data-clip="${clipNum}" data-criterion="${index}" data-score="${score}">
                                        ${score}
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                    `;
                });

                container.innerHTML = html;
                updateClipProgress(clipNum);
            }
        }

        function setScore(clipNum, criterionIndex, score) {
            const buttons = document.querySelectorAll(`[data-clip="${clipNum}"][data-criterion="${criterionIndex}"]`);
            buttons.forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');

            scores[clipNum][criterionIndex] = score;

            const criterion = document.getElementById(`criterion-${clipNum}-${criterionIndex}`);
            if (criterion) {
                criterion.classList.remove('incomplete');
                criterion.classList.add('completed');
            }

            updateClipProgress(clipNum);
        }

        function updateClipProgress(clipNum) {
            const clipScores = scores[clipNum];
            const completedCount = Object.keys(clipScores).length;
            const totalCriteria = criteria.length;
            const isComplete = completedCount === totalCriteria;

            const progressBar = document.querySelector(`#clip-progress-${clipNum}`);
            if (progressBar) {
                const percentage = Math.round((completedCount / totalCriteria) * 100);
                progressBar.style.width = percentage + '%';

                const progressText = document.querySelector(`#clip-progress-text-${clipNum}`);
                if (progressText) {
                    progressText.textContent = `${completedCount}/${totalCriteria} ‡∏Ç‡πâ‡∏≠ (${percentage}%)`;
                }
            }

            const nextButton = document.querySelector(`#next-btn-${clipNum}`);
            if (nextButton) {
                if (isComplete) {
                    nextButton.disabled = false;
                    nextButton.classList.remove('btn-disabled');
                    nextButton.classList.add('btn');
                    // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 7
                    nextButton.innerHTML = clipNum === 7 ? '‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ‚Üí' : `‡∏ñ‡∏±‡∏î‡πÑ‡∏õ: ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum + 1} ‚Üí`;
                } else {
                    nextButton.disabled = true;
                    nextButton.classList.add('btn-disabled');
                    nextButton.classList.remove('btn');
                    nextButton.innerHTML = `‚ùå ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö (${completedCount}/${totalCriteria})`;
                }
            }

            const warningDiv = document.querySelector(`#warning-${clipNum}`);
            if (warningDiv) {
                if (isComplete) {
                    warningDiv.style.display = 'none';
                } else {
                    warningDiv.style.display = 'block';
                    warningDiv.innerHTML = `
                        <div class="alert alert-warning">
                            ‚ö†Ô∏è <strong>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠:</strong> ‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î ${totalCriteria - completedCount} ‡∏Ç‡πâ‡∏≠
                        </div>
                    `;
                }
            }
        }

        function startEvaluation() {
            try {
                if (!currentJudge) {
                    document.getElementById('noTokenMessage').classList.remove('hidden');
                    document.getElementById('welcomeActions').classList.add('hidden');
                    return;
                }

                if (systemSettings.status === 'closed') {
                    goToPage('closed');
                    return;
                }

                console.log('üöÄ Starting evaluation for:', currentJudge.name);
                goToPage('clip-1');

            } catch (error) {
                console.error('Error starting evaluation:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }

        function nextClip(currentClip) {
            const clipScores = scores[currentClip];
            const completedCount = Object.keys(clipScores).length;
            const totalCriteria = criteria.length;

            if (completedCount < totalCriteria) {
                alert(`‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô\n‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ${completedCount}/${totalCriteria} ‡∏Ç‡πâ‡∏≠\n‡∏¢‡∏±‡∏á‡∏Ç‡∏≤‡∏î: ${totalCriteria - completedCount} ‡∏Ç‡πâ‡∏≠`);
                return;
            }

            const nextClipNum = currentClip + 1;
            if (nextClipNum <= 7) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                goToPage(`clip-${nextClipNum}`);
            } else {
                goToPage('summary');
            }
        }

        function goToSummary() {
            const clipScores = scores[7]; // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å scores[4] ‡πÄ‡∏õ‡πá‡∏ô scores[7]
            const completedCount = Object.keys(clipScores).length;
            const totalCriteria = criteria.length;

            if (completedCount < totalCriteria) {
                alert(`‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà 7 ‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠‡∏Å‡πà‡∏≠‡∏ô\n‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ${completedCount}/${totalCriteria} ‡∏Ç‡πâ‡∏≠`);
                return;
            }

            goToPage('summary');
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç generateSummary ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        function generateSummary() {
            const container = document.getElementById('summaryContent');
            let html = '';

            for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                const clipScores = scores[clipNum];
                const total = Object.values(clipScores).reduce((sum, score) => sum + score, 0);
                const completedCriteria = Object.keys(clipScores).length;

                // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∑‡πà‡∏≠‡∏Ñ‡∏•‡∏¥‡∏õ
                const clipNames = {
                    1: '‡πÄ‡∏ö‡πâ‡∏ö',
                    2: '‡πÄ‡∏à‡∏•‡∏¥', 
                    3: '‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà',
                    4: 'Sm',
                    5: 'xtr_4440',
                    6: 'thisisnarumi',
                    7: 'wtlp93'
                };

                html += `
                    <div class="summary-card">
                        <div class="clip-summary">
                            <h3>üì± ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum} : ${clipNames[clipNum]}</h3>
                            <div>
                                <strong>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°:</strong> ${total}/50 
                                <span style="color: #666;">(${completedCriteria}/10 ‡∏Ç‡πâ‡∏≠)</span>
                            </div>
                        </div>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            ${criteria.map((criterion, index) => `
                                <div style="background: ${clipScores[index] ? '#e8f5e8' : '#fff3cd'}; 
                                           padding: 5px 10px; border-radius: 5px; font-size: 14px;">
                                    ${index + 1}: ${clipScores[index] || '-'}
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç submitAllScores ‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        async function submitAllScores() {
            if (!currentJudge || !supabase) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö');
                return;
            }

            if (systemSettings.status === 'closed') {
                alert('‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
                return;
            }

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏•‡∏¥‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏£‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏±‡∏á
            let incompleteClips = [];
            for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                const completedCount = Object.keys(scores[clipNum]).length;
                if (completedCount < criteria.length) {
                    const clipNames = {
                        1: '‡πÄ‡∏ö‡πâ‡∏ö', 2: '‡πÄ‡∏à‡∏•‡∏¥', 3: '‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà', 4: 'Sm',
                        5: 'xtr_4440', 6: 'thisisnarumi', 7: 'wtlp93'
                    };
                    incompleteClips.push(`‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum} : ${clipNames[clipNum]} (${completedCount}/${criteria.length})`);
                }
            }

            if (incompleteClips.length > 0) {
                alert(`‚ùå ‡∏¢‡∏±‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ:\n${incompleteClips.join('\n')}\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠`);
                return;
            }

            if (!confirm('‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô?\n‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ')) {
                return;
            }

            showLoading(true);

            try {
                const scoresData = [];

                for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                    const clipScores = scores[clipNum];
                    const total = Object.values(clipScores).reduce((sum, score) => sum + score, 0);

                    scoresData.push({
                        judge_id: currentJudge.id,
                        clip_id: clipNum,
                        q1: clipScores[0] || null,
                        q2: clipScores[1] || null,
                        q3: clipScores[2] || null,
                        q4: clipScores[3] || null,
                        q5: clipScores[4] || null,
                        q6: clipScores[5] || null,
                        q7: clipScores[6] || null,
                        q8: clipScores[7] || null,
                        q9: clipScores[8] || null,
                        q10: clipScores[9] || null,
                        total_score: total
                    });
                }

                const { error: scoresError } = await supabase
                    .from('scores')
                    .insert(scoresData);

                if (scoresError) throw scoresError;

                const { error: judgeError } = await supabase
                    .from('judges')
                    .update({ used: true })
                    .eq('id', currentJudge.id);

                if (judgeError) throw judgeError;

                goToPage('thanks');

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // Admin Functions
        async function loadAdminStats() {
            if (!supabase) return;

            try {
                const [judgesResult, scoresResult] = await Promise.all([
                    supabase.from('judges').select('*'),
                    supabase.from('scores').select('*')
                ]);

                const judges = judgesResult.data || [];
                const scores = scoresResult.data || [];

                document.getElementById('totalJudges').textContent = judges.length;
                document.getElementById('completedJudges').textContent = judges.filter(j => j.used).length;

                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏õ (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö 7 ‡∏Ñ‡∏•‡∏¥‡∏õ)
                const clipAverages = {};
                for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                    const clipScores = scores.filter(s => s.clip_id === clipNum);
                    if (clipScores.length > 0) {
                        const totalScore = clipScores.reduce((sum, s) => sum + (s.total_score || 0), 0);
                        clipAverages[clipNum] = (totalScore / clipScores.length).toFixed(2);
                    } else {
                        clipAverages[clipNum] = 0;
                    }
                }

                // ‡∏´‡∏≤‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î
                const maxAverage = Math.max(...Object.values(clipAverages).map(avg => parseFloat(avg)));
                document.getElementById('averageWinner').textContent = maxAverage.toFixed(2);

                // Load system status
                const { data: settings } = await supabase
                    .from('settings')
                    .select('value')
                    .eq('key', 'system_status')
                    .single();

                if (settings) {
                    document.getElementById('systemStatus').value = settings.value;
                    systemSettings.status = settings.value;
                }

            } catch (error) {
                console.error('Error loading admin stats:', error);
            }
        }

        async function updateSystemStatus() {
            const status = document.getElementById('systemStatus').value;

            try {
                const { error } = await supabase
                    .from('settings')
                    .upsert({
                        key: 'system_status',
                        value: status,
                        updated_at: new Date().toISOString()
                    }, {
                        onConflict: 'key'
                    });

                if (error) throw error;

                systemSettings.status = status;
                alert(`‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô "${status === 'open' ? '‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô' : '‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏•‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô'}" ‡πÅ‡∏•‡πâ‡∏ß`);

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }

        async function createAllJudges() {
            if (!confirm('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ 10 ‡∏Ñ‡∏ô ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥?')) return;

            showLoading(true);

            try {
                const judgesData = [];
                for (let i = 1; i <= 10; i++) {
                    const token = 'judge' + Date.now() + Math.random().toString(36).substr(2, 8);
                    judgesData.push({
                        name: `‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ ${String.fromCharCode(64 + i)}`,
                        access_token: token
                    });
                }

                const { error } = await supabase
                    .from('judges')
                    .insert(judgesData);

                if (error) throw error;

                alert('‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ 10 ‡∏Ñ‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
                loadAdminStats();

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function showJudgeLinks() {
            showLoading(true);

            try {
                const { data: judges, error } = await supabase
                    .from('judges')
                    .select('*')
                    .order('created_at', { ascending: true });

                if (error) {
                    console.error('Database error:', error);
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ' + error.message);
                    showLoading(false);
                    return;
                }

                if (!judges || judges.length === 0) {
                    alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô');
                    showLoading(false);
                    return;
                }

                const baseUrl = window.location.origin + window.location.pathname;
                let html = `<h4>‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (${judges.length} ‡∏Ñ‡∏ô)</h4>`;

                judges.forEach((judge, index) => {
                    const judgeUrl = `${baseUrl}?token=${judge.access_token}`;
                    const status = judge.used ? '‚úÖ ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß' : '‚è≥ ‡∏£‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô';

                    html += `
                        <div style="background: white; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid ${judge.used ? '#28a745' : '#ffc107'};">
                            <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                                <div style="margin-bottom: 10px;">
                                    <strong>${judge.name}</strong><br>
                                    <small style="color: #666;">${status}</small>
                                </div>
                                <div>
                                    <button class="btn" onclick="copyToClipboard('${judgeUrl}')" style="margin: 2px;">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                                    <button class="btn btn-secondary" onclick="window.open('${judgeUrl}', '_blank')" style="margin: 2px;">üîó ‡πÄ‡∏õ‡∏¥‡∏î</button>
                                    <button class="btn btn-danger" onclick="deleteJudge('${judge.id}', '${judge.name}')" style="margin: 2px;">üóëÔ∏è ‡∏•‡∏ö</button>
                                </div>
                            </div>
                            <div style="font-size: 12px; color: #666; margin-top: 5px; word-break: break-all; background: #f8f9fa; padding: 5px; border-radius: 4px;">
                                ${judgeUrl}
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-secondary" onclick="exportAllLinks()">üìã ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <button class="btn btn-danger" onclick="deleteAllJudges()">üóëÔ∏è ‡∏•‡∏ö‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                    </div>
                `;

                document.getElementById('judgeLinksDisplay').innerHTML = html;
                document.getElementById('judgeLinksDisplay').classList.remove('hidden');

            } catch (error) {
                console.error('Unexpected error:', error);
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏Ñ‡∏≤‡∏î‡∏Ñ‡∏¥‡∏î: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        async function exportAllLinks() {
            try {
                const { data: judges } = await supabase.from('judges').select('*').order('created_at');
                const baseUrl = window.location.origin + window.location.pathname;

                let text = 'üé¨ ‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok (7 ‡∏Ñ‡∏•‡∏¥‡∏õ)\n\n';
                judges.forEach((judge, index) => {
                    const url = `${baseUrl}?token=${judge.access_token}`;
                    const status = judge.used ? '(‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß)' : '(‡∏£‡∏≠‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô)';
                    text += `${judge.name} ${status}\n${url}\n\n`;
                });

                navigator.clipboard.writeText(text);
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß!');

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }

        async function deleteJudge(judgeId, judgeName) {
            if (!confirm(`‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö "${judgeName}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) return;

            try {
                await supabase.from('scores').delete().eq('judge_id', judgeId);
                const { error } = await supabase.from('judges').delete().eq('id', judgeId);

                if (error) throw error;

                alert('‡∏•‡∏ö‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                loadAdminStats();
                showJudgeLinks();

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }

        async function deleteAllJudges() {
            if (!confirm('‚ö†Ô∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) return;
            if (!confirm('‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á: ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏∞‡∏´‡∏≤‡∏¢‡πÑ‡∏õ!')) return;

            showLoading(true);

            try {
                await supabase.from('scores').delete().neq('id', '00000000-0000-0000-0000-000000000000');
                await supabase.from('judges').delete().neq('id', '00000000-0000-0000-0000-000000000000');

                alert('‡∏•‡∏ö‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
                loadAdminStats();
                document.getElementById('judgeLinksDisplay').classList.add('hidden');

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç showResults ‡πÉ‡∏´‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        async function showResults() {
            showLoading(true);

            try {
                const { data: scores } = await supabase.from('scores').select('*');
                const { data: judges } = await supabase.from('judges').select('*');

                // ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
                const clipResults = {};
                const clipNames = {
                    1: '‡πÄ‡∏ö‡πâ‡∏ö', 2: '‡πÄ‡∏à‡∏•‡∏¥', 3: '‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà', 4: 'Sm',
                    5: 'xtr_4440', 6: 'thisisnarumi', 7: 'wtlp93'
                };

                for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                    const clipScores = scores.filter(s => s.clip_id === clipNum);
                    const totalScore = clipScores.reduce((sum, s) => sum + (s.total_score || 0), 0);
                    const avgScore = clipScores.length > 0 ? (totalScore / clipScores.length).toFixed(2) : 0;

                    clipResults[clipNum] = {
                        name: clipNames[clipNum],
                        judges: clipScores.length,
                        total: totalScore,
                        average: parseFloat(avgScore)
                    };
                }

                // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢
                const sortedClips = Object.entries(clipResults)
                    .sort(([, a], [, b]) => b.average - a.average);

                let html = '<h4>üèÜ ‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö (7 ‡∏Ñ‡∏•‡∏¥‡∏õ)</h4>';
                html += '<div style="background: white; padding: 20px; border-radius: 10px; margin: 10px 0;">';

                sortedClips.forEach(([clipNum, result], index) => {
                    const rank = index + 1;
                    const medal = rank === 1 ? 'ü•á' : rank === 2 ? 'ü•à' : rank === 3 ? 'ü•â' : `${rank}.`;

                    html += `
                        <div style="padding: 15px; margin: 10px 0; border-radius: 8px; background: ${rank <= 3 ? '#f8f9fa' : '#fff'}; border-left: 4px solid ${rank === 1 ? '#FFD700' : rank === 2 ? '#C0C0C0' : rank === 3 ? '#CD7F32' : '#ddd'};">
                            <strong>${medal} ‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum} : ${result.name}</strong><br>
                            ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢: <strong>${result.average}</strong> ‡∏à‡∏≤‡∏Å ${result.judges} ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£<br>
                            ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${result.total}
                        </div>
                    `;
                });

                html += '</div>';

                document.getElementById('resultsDisplay').innerHTML = html;
                document.getElementById('resultsDisplay').classList.remove('hidden');

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            } finally {
                showLoading(false);
            }
        }

        // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç exportResults ‡πÉ‡∏´‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö 7 ‡∏Ñ‡∏•‡∏¥‡∏õ
        async function exportResults() {
            try {
                const { data: scores } = await supabase.from('scores').select('*');
                const { data: judges } = await supabase.from('judges').select('*');

                let text = 'üìä ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok (7 ‡∏Ñ‡∏•‡∏¥‡∏õ)\n';
                text += `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${new Date().toLocaleDateString('th-TH')}\n\n`;

                const clipNames = {
                    1: '‡πÄ‡∏ö‡πâ‡∏ö', 2: '‡πÄ‡∏à‡∏•‡∏¥', 3: '‡∏£‡∏≤‡∏°‡∏°‡∏µ‡πà', 4: 'Sm',
                    5: 'xtr_4440', 6: 'thisisnarumi', 7: 'wtlp93'
                };

                // ‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏•‡∏¥‡∏õ
                for (let clipNum = 1; clipNum <= 7; clipNum++) { // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 4 ‡πÄ‡∏õ‡πá‡∏ô 7
                    const clipScores = scores.filter(s => s.clip_id === clipNum);
                    const total = clipScores.reduce((sum, s) => sum + (s.total_score || 0), 0);
                    const avg = clipScores.length > 0 ? (total / clipScores.length).toFixed(2) : 0;

                    text += `‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ó‡∏µ‡πà ${clipNum} : ${clipNames[clipNum]} - ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢ ${avg} (${clipScores.length} ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£)\n`;
                }

                text += `\n‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥:\n`;
                text += `- ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${judges.length} ‡∏Ñ‡∏ô\n`;
                text += `- ‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß: ${judges.filter(j => j.used).length} ‡∏Ñ‡∏ô\n`;
                text += `- ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö: ${scores.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n`;

                navigator.clipboard.writeText(text);
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÅ‡∏•‡πâ‡∏ß!');

            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message);
            }
        }

        // Utility functions
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß!');
            });
        }

        function showLoading(show) {
            document.getElementById('loading').classList.toggle('hidden', !show);
        }

        // Console helpers
        console.log('üé¨ ‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏•‡∏¥‡∏õ TikTok (7 ‡∏Ñ‡∏•‡∏¥‡∏õ)');
        console.log('üîß Admin URL:', window.location.origin + window.location.pathname + '?admin=true');
        console.log('üìö GitHub Deployment Guide:');
        console.log('1. ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô index.html');
        console.log('2. ‡∏™‡∏£‡πâ‡∏≤‡∏á Repository ‡πÉ‡∏´‡∏°‡πà‡∏ö‡∏ô GitHub');
        console.log('3. ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå index.html');
        console.log('4. ‡πÑ‡∏õ Settings ‚Üí Pages ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å main branch');
        console.log('5. ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà https://yourusername.github.io/repository-name');
    </script>
</body>

</html>